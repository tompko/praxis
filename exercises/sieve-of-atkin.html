<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
<title>Sieve Of Atkin &laquo;  Programming Praxis</title>
</head>
<body>
<div class="entrytitle">
<h2>Sieve Of&nbsp;Atkin</h2>
<h3>February 12, 2010</h3>
</div>
<div class="entrybody">
<p>We examined the use of the Sieve of Eratosthenes for enumerating the prime numbers, a method that dates to the ancient Greeks, in two <a href="/2009/02/19/sieve-of-eratosthenes/">previous</a> <a href="/2010/02/05/segmented-sieve-of-eratosthenes/">exercises</a>.  Just a few years ago, in 2004, A. O. L. Atkin and D. J. Bernstein developed a new method, called the Sieve of Atkin, that performs the same task more quickly.  The new method first marks squarefree potential primes, then eliminates those potential primes that are not squarefree.</p>
<p>Atkin&#8217;s sieve begins with a boolean array (bits are fine) of length <em>n</em> equal to the number of items to be sieved; each element of the array is initially false.</p>
<p>Squarefree potential primes are marked like this:  For each element <em>k</em> of the array for which <em>k</em> &equiv; 1 (mod 12) or <em>k</em> &equiv; 5 (mod 12) and there exists some  4<em>x</em>&sup2; + <em>y</em>&sup2; = <em>k</em> for positive integers <em>x</em> and <em>y</em>, flip the sieve element (set true elements to false, and false elements to true).  For each element <em>k</em> of the array for which <em>k</em> &equiv; 7 (mod 12) and there exists some 3<em>x</em>&sup2; + <em>y</em>&sup2; = <em>k</em> for positive integers <em>x</em> and <em>y</em>, flip the sieve element.  For each element <em>k</em> of the array for which <em>k</em> &equiv; 11 (mod 12) and there exists some 3<em>x</em>&sup2; &#8211; <em>y</em>&sup2; = <em>k</em> for positive integers <em>x</em> and <em>y</em> with <em>x</em> &gt; <em>y</em>, flip the sieve element.</p>
<p>Once this preprocessing is complete, the actual sieving is performed by running through the sieve starting at 7.  For each true element of the array, mark all multiples of the square of the element as false (regardless of their current setting).  The remaining true elements are prime.</p>
<p>Your task is to write a function to sieve primes using the Sieve of Atkin.  When you are finished, you are welcome to <a href="/2010/02/12/sieve-of-atkin/2/">read</a> or <a href="http://programmingpraxis.codepad.org/WAgoUQGS">run</a> a suggested solution, or to post your own solution or discuss the exercise in the comments below.</p>
<div id="wpcom_below_post" class="wpadvert" style="text-align: center; padding: 5px; background: #; padding: 5px; margin: 10px auto; width: 310px;">
<!-- <span style="text-align: left; letter-spacing: 1px; font: 8px/1em Verdana, sans-serif; color: #ccc; text-transform: uppercase; display: block; padding: 0 1px;">Advertisement</span> -->
<script type="text/javascript">
LD_AddCustomAttr("AdOpt", "1");
LD_AddCustomAttr("Origin", "other");
LD_AddCustomAttr("theme_bg", "ffffff"); 
LD_AddCustomAttr("theme_text", "555555"); 
LD_AddCustomAttr("theme_link", "557799"); 
LD_AddCustomAttr("theme_border", "C8A799"); 
LD_AddCustomAttr("theme_url", "8FB1D3"); 
LD_AddCustomAttr("LangId", "1");
LD_AddCustomAttr("Autotag", "technology");
LD_AddCustomAttr("Tag", "exercises");

LD_AddSlot("wpcom_below_post");
LD_GetBids();
</script>
</div><div class="sharedaddy sd-like-enabled"><div id="wpl-likebox" class="sd-block sd-like"><h3 class="sd-title">Like this:</h3><div class="sd-content"><div id="wpl-button"><a href="http://programmingpraxis.com/2010/02/12/sieve-of-atkin/?like=1&amp;_wpnonce=a72c2c6ab5" title="I like this post" class="like needs-login sd-button" rel="nofollow"><span>Like</span></a></div><div id="wpl-count" class="sd-like-count">Be the first to like this post.</div></div></div></div> <p>Pages: 1 <a href="http://programmingpraxis.com/2010/02/12/sieve-of-atkin/2/">2</a></p> </div></div>
</body>
</html>
