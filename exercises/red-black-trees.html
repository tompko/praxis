<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
<title>Red-Black Trees &laquo;  Programming Praxis</title>
</head>
<body>
<div class="entrytitle">
<h2>Red-Black&nbsp;Trees</h2>
<h3>October 2, 2009</h3>
</div>
<div class="entrybody">
<p><img src="http://programmingpraxis.files.wordpress.com/2009/10/red-black.png?w=640" alt="By Colin Burnet.  Used under Creative Commons Attribution Share-Alike 3.0 license" title="red-black" class="size-full wp-image-1411" align="right" /></p>
<p>A red-black tree is a data structure, similar to a binary tree, which is always approximately balanced, so that individual insert and lookup operations take only <em>O</em>(log <em>n</em>) time.  Red-black trees are popular because of their good performance and the relative simplicity of their balancing operations.  Our discussion of red-black trees is drawn from Section 3.3 of Chris Okasaki&#8217;s book <em>Purely Functional Data Structures</em>.</p>
<p>A red-black tree is a binary search tree in which each node is colored either red or black.  A red-black tree maintains two invariants that ensure its balance:</p>
<ul>
<li>No red node ever has a red child.</li>
<li>Every path from the root to an empty node has the same number of black nodes.</li>
</ul>
<p>Thus, the shortest possible path has only black nodes, and the longest possible path has alternating red and black nodes, so the longest path is never more than twice as long as the shortest path, and the tree is approximately balanced.</p>
<p>Lookup in red-black trees is identical to its binary-tree counterpart; the colors make no difference.  The balance condition is maintained by the insert operation.  Each new node is initially colored red.  If its parent is black, the tree remains balanced, and nothing need be done.  However, if its parent is red, the first invariant is violated, and a balancing function is called to repair the violation by rewriting the black-red-red path as a red node with two black children.  This may propagate the invariant up the tree, so the balancing function is called recursively until it reaches the root of the tree, which is always recolored black.</p>
<p>Your task is to write functions to maintain red-black trees; you should provide an insert function, a lookup function, and an enlist function that returns a list with the nodes of the tree in order.  Each node should contain a key and a value, so the red-black tree can be used as a dictionary, in the manner of the treaps and ternary search tries that we have written in previous exercises.  When you are finished, you are welcome to <a href="/2009/10/02/red-black-trees/2/">read</a> or <a href="http://programmingpraxis.codepad.org/UA6qxeO7">run</a> a suggested solution, or to post your own solution or discuss the exercise in the comments below.</p>
<div id="wpcom_below_post" class="wpadvert" style="text-align: center; padding: 5px; background: #; padding: 5px; margin: 10px auto; width: 310px;">
<!-- <span style="text-align: left; letter-spacing: 1px; font: 8px/1em Verdana, sans-serif; color: #ccc; text-transform: uppercase; display: block; padding: 0 1px;">Advertisement</span> -->
<script type="text/javascript">
LD_AddCustomAttr("AdOpt", "1");
LD_AddCustomAttr("Origin", "other");
LD_AddCustomAttr("theme_bg", "ffffff"); 
LD_AddCustomAttr("theme_text", "555555"); 
LD_AddCustomAttr("theme_link", "557799"); 
LD_AddCustomAttr("theme_border", "C8A799"); 
LD_AddCustomAttr("theme_url", "8FB1D3"); 
LD_AddCustomAttr("LangId", "1");
LD_AddCustomAttr("Autotag", "technology");
LD_AddCustomAttr("Autotag", "entertainment");
LD_AddCustomAttr("Autotag", "science");
LD_AddCustomAttr("Tag", "exercises");

LD_AddSlot("wpcom_below_post");
LD_GetBids();
</script>
</div><div class="sharedaddy sd-like-enabled"><div id="wpl-likebox" class="sd-block sd-like"><h3 class="sd-title">Like this:</h3><div class="sd-content"><div id="wpl-button"><a href="http://programmingpraxis.com/2009/10/02/red-black-trees/?like=1&amp;_wpnonce=a72c2c6ab5" title="I like this post" class="like needs-login sd-button" rel="nofollow"><span>Like</span></a></div><div id="wpl-count" class="sd-like-count">Be the first to like this post.</div></div></div></div> <p>Pages: 1 <a href="http://programmingpraxis.com/2009/10/02/red-black-trees/2/">2</a></p> </div></div>
</body>
</html>
