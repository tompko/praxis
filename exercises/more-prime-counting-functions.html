<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
<title>More Prime-Counting Functions &laquo;  Programming Praxis</title>
</head>
<body>
<div class="entrytitle">
<h2>More Prime-Counting&nbsp;Functions</h2>
<h3>July 26, 2011</h3>
</div>
<div class="entrybody">
<p>In the <a href="/2011/07/22/counting-primes-using-legendres-formula/">previous exercise</a> we studied Legendre&#8217;s prime-counting function.  In today&#8217;s exercise we will look at two more prime-counting functions, one from Ernst Meissel in the late 1800s and the other from Derrick Lehmer in the mid 1990s. </p>
<p>Both formulas are based on Legendre&#8217;s original formula; in both cases, they simply rearrange the terms of Legendre&#8217;s formula to eliminate some work. We won&#8217;t try to give derivations, as they are complex and chock-full of Greek letters; if you are interested, Hans Riesel&#8217;s book <em>Prime Numbers and Computer Methods for Factorization</em> was the source for all three formulas.</p>
<p>Meissel: <img src="http://s0.wp.com/latex.php?latex=%5Cpi%28x%29+%3D+%5Cphi%28x%2C+c%29+%2B+%5Cfrac%7B%28b%2Bc-2%29%28b-c%2B1%29%7D%7B2%7D+-+%5Csum_%7Bi%3Dc%2B1%7D%5Eb+%5Cpi%5Cleft%28%5Cleft%5Clfloor%5Cfrac%7Bx%7D%7Bp_i%7D%5Cright%5Crfloor%5Cright%29&amp;bg=ffffff&amp;fg=555555&amp;s=0" alt="\pi(x) = \phi(x, c) + \frac{(b+c-2)(b-c+1)}{2} - \sum_{i=c+1}^b \pi\left(\left\lfloor\frac{x}{p_i}\right\rfloor\right)" title="\pi(x) = \phi(x, c) + \frac{(b+c-2)(b-c+1)}{2} - \sum_{i=c+1}^b \pi\left(\left\lfloor\frac{x}{p_i}\right\rfloor\right)" class="latex" />, where <img src="http://s0.wp.com/latex.php?latex=b+%3D+%5Cpi%28%5Clfloor+%5Csqrt%7Bx%7D+%5Crfloor%29&amp;bg=ffffff&amp;fg=555555&amp;s=0" alt="b = \pi(\lfloor \sqrt{x} \rfloor)" title="b = \pi(\lfloor \sqrt{x} \rfloor)" class="latex" /> and <img src="http://s0.wp.com/latex.php?latex=c+%3D+%5Cpi%28%5Clfloor+%5Csqrt%5B3%5D%7Bx%7D+%5Crfloor%29&amp;bg=ffffff&amp;fg=555555&amp;s=0" alt="c = \pi(\lfloor \sqrt[3]{x} \rfloor)" title="c = \pi(\lfloor \sqrt[3]{x} \rfloor)" class="latex" /></p>
<p>Lehmer: <img src="http://s0.wp.com/latex.php?latex=%5Cpi%28x%29+%3D+%5Cphi%28x%2C+c%29+%2B+%5Cfrac%7B%28b%2Ba-2%29%28b-a%2B1%29%7D%7B2%7D+-+%5Csum_%7Bi%3Da%2B1%7D%5Eb+%5Cpi+%5Cleft%28+%5Cleft%5Clfloor+%5Cfrac%7Bx%7D%7Bp_i%7D+%5Cright%5Crfloor+%5Cright%29+-+%5Csum_%7Bi%3Da%2B1%7D%5Ec+%5Csum_%7Bj%3Di%7D%5E%7Bb_i%7D+%5Cleft%28+%5Cpi+%5Cleft%28+%5Cleft%5Clfloor+%5Cfrac%7Bx%7D%7Bp_i+p_j%7D+%5Cright%5Crfloor+%5Cright%29+-+%28j-1%29+%5Cright%29&amp;bg=ffffff&amp;fg=555555&amp;s=0" alt="\pi(x) = \phi(x, c) + \frac{(b+a-2)(b-a+1)}{2} - \sum_{i=a+1}^b \pi \left( \left\lfloor \frac{x}{p_i} \right\rfloor \right) - \sum_{i=a+1}^c \sum_{j=i}^{b_i} \left( \pi \left( \left\lfloor \frac{x}{p_i p_j} \right\rfloor \right) - (j-1) \right)" title="\pi(x) = \phi(x, c) + \frac{(b+a-2)(b-a+1)}{2} - \sum_{i=a+1}^b \pi \left( \left\lfloor \frac{x}{p_i} \right\rfloor \right) - \sum_{i=a+1}^c \sum_{j=i}^{b_i} \left( \pi \left( \left\lfloor \frac{x}{p_i p_j} \right\rfloor \right) - (j-1) \right)" class="latex" />, where <img src="http://s0.wp.com/latex.php?latex=a+%3D+%5Cpi%28%5Clfloor+%5Csqrt%5B4%5D%7Bx%7D+%5Crfloor%29&amp;bg=ffffff&amp;fg=555555&amp;s=0" alt="a = \pi(\lfloor \sqrt[4]{x} \rfloor)" title="a = \pi(\lfloor \sqrt[4]{x} \rfloor)" class="latex" />, <img src="http://s0.wp.com/latex.php?latex=b+%3D+%5Cpi%28%5Clfloor+%5Csqrt%7Bx%7D+%5Crfloor%29&amp;bg=ffffff&amp;fg=555555&amp;s=0" alt="b = \pi(\lfloor \sqrt{x} \rfloor)" title="b = \pi(\lfloor \sqrt{x} \rfloor)" class="latex" />, <img src="http://s0.wp.com/latex.php?latex=c+%3D+%5Cpi%28%5Clfloor+%5Csqrt%5B3%5D%7Bx%7D+%5Crfloor%29&amp;bg=ffffff&amp;fg=555555&amp;s=0" alt="c = \pi(\lfloor \sqrt[3]{x} \rfloor)" title="c = \pi(\lfloor \sqrt[3]{x} \rfloor)" class="latex" />, and <img src="http://s0.wp.com/latex.php?latex=b_i+%3D+%5Cpi%28%5Clfloor+%5Csqrt%7Bx+%2F+p_i%7D+%5Crfloor%29&amp;bg=ffffff&amp;fg=555555&amp;s=0" alt="b_i = \pi(\lfloor \sqrt{x / p_i} \rfloor)" title="b_i = \pi(\lfloor \sqrt{x / p_i} \rfloor)" class="latex" /> for <img src="http://s0.wp.com/latex.php?latex=a+%3C+i+%3C%3D+c&amp;bg=ffffff&amp;fg=555555&amp;s=0" alt="a &lt; i &lt;= c" title="a &lt; i &lt;= c" class="latex" />.</p>
<p>Your task is to implement the prime-counting functions of Meissel and Lehmer, then compare timings with Legendre&#039;s prime-counting function of the <a href="/2011/07/22/counting-primes-using-legendres-formula/">previous exercise</a>. When you are finished, you are welcome to <a href="/2011/07/26/more-prime-counting-functions/2/">read</a> or <a href="http://programmingpraxis.codepad.org/grLPbEPx">run</a> a suggested solution, or to post your own solution or discuss the exercise in the comments below.</p>
</div>
</body>
</html>
