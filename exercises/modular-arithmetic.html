<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
<title>Modular Arithmetic &laquo;  Programming Praxis</title>
</head>
<body>
<div class="entrytitle">
<h2>Modular&nbsp;Arithmetic</h2>
<h3>July 7, 2009</h3>
</div>
<div class="entrybody">
<p>Modular arithmetic is a branch of number theory that is useful in its own right and as a tool in such disciplines as integer factorization, calendrical and astronomical calculations, and cryptography.  Modular arithmetic was systematized by Carl Friedrich Gauss in his book <em>Disquisitiones Arithmeticae</em>, published in 1801.</p>
<p>Modular arithmetic is a system of arithmetic for integers in which all results are expressed as non-negative integers less than the modulus.  A familiar use of modular arithmetic is the twelve-hour clock, in which eight hours after nine o’clock is five o&#8217;clock; that is, 9 + 8 ≡ 5 (mod 12).  The &equiv; sign used in modular arithmetic specifies congruence, not equality.  Two numbers are congruent in a given modulus if the difference between them is an even multiple of the modulus; for instance 17 &equiv; 5 (mod 12).  Modular addition is like regular addition, but &#8220;wraps around&#8221; at the modulus.  Modular subtraction is the inverse operation of modular addition, and modular multiplication is just repeated modular addition; for instance 4 &minus; 9 &equiv; 7 (mod 12), and 3 &times; 7 &equiv; 9 (mod 12).</p>
<p>Modular division is the inverse operation of modular multiplication, just as regular division is the inverse operation of regular multiplication.  In modular arithmetic, the modular inverse of an integer <em>p</em> is that integer <em>q</em> for which <em>p</em> &times; <em>q</em> &equiv; 1 (mod <em>n</em>); the modular inverse is undefined, just as division by zero is undefined, unless the target number is coprime to the modulus.  The extended Euclidean algorithm calculates the inverse; given <em>ax</em> + <em>by</em> = <em>g</em> = gcd(<em>x</em>, <em>y</em>), when <em>g</em> = 1 and <em>x</em> &gt; 0, <em>b</em> (mod <em>x</em>) and <em>a</em> (mod <em>y</em>) are the inverses of <em>y</em> (mod <em>x</em>) and <em>x</em> (mod <em>y</em>), respectively.  Then modular division is just modular multiplication by the inverse.  For instance, 9 &divide; 7 &equiv; 3 (mod 12).</p>
<p>Exponentiation in modular arithmetic is repeated modular multiplication, just as exponentiation is repeated multiplication in normal arithmetic.  Modular exponentiation could be performed by first computing the exponentiation and then performing the modulo operation, but that could involve a large intermediate result.  A better method performs the modulo operations at each multiplication, squaring when possible to reduce the number of intermediate multiplications.</p>
<p>Square root is defined in modular arithmetic as that number which, when multiplied by itself, equals the target number, just as in normal arithmetic.  And just as in normal arithmetic, every square root has a conjugate on the &#8220;other side&#8221; of zero, except that in modular arithmetic there is no &#8220;other side&#8221; of zero, so the two conjugates are the negatives of each other, adding to the modulus.  For instance the square roots of 18 (mod 31) are 7 and 24, since 7 &times; 7 &equiv; 18 (mod 31) and 24 &times; 24 &equiv; 18 (mod 31), and 7 + 24 = 31.</p>
<p>Square root is a more difficult concept in modular arithmetic than regular arithmetic, because there are many cases where the modular square root does not exist.  For instance, consider the squares <em>x</em><sup>2</sup> (mod 13), 0 &le; <em>x</em> &lt; 13: 0, 1, 4, 9, 3, 12, 10, 10, 12, 3, 9, 4, 1.  There is no number that can be squared modulo 13 to evaluate to 7, so the square root of 7 modulo 13 does not exist; the only numbers that have square roots modulo 13 are 1, 3, 4, 9, 10, and 12, or, equivalently, &plusmn;1, &plusmn;3, and &plusmn;4.  Another restriction is that the modular square root is only defined if the modulus is an odd prime.  For instance, consider the squares <em>x</em><sup>2</sup> (mod 15), 0 &le; <em>x</em> &lt; 15: 0, 1, 4, 9, 1, 10, 6, 4, 4, 6, 10, 1, 9, 4, 1.  The number 4 has two sets of conjugate square roots: &plusmn;2 and &plusmn;7. Since the solution is not unique, the modular square root can be said not to exist when the modulus is composite.</p>
<p>If you need a refresher on the math that supports modular arithmetic, you can look at any number theory textbook, or search the internet for terms such as modular arithmetic, bezout identity, modular inverse, jacobi symbol, and quadratic residue.</p>
<p>Your task is to write a library that provides convenient access to the basic operations of modular arithmetic: addition, subtraction, multiplication, division, exponentiation, and square root. When you are finished, you are welcome to <a href="/2009/07/07/modular-arithmetic/2/">read</a> or <a href="http://programmingpraxis.codepad.org/1QA39Fbf">run</a> a suggested solution, or to post your own solution or discuss the exercise in the comments below.</p>
</div>
</body>
</html>
