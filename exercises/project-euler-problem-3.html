<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
<title>Project Euler Problem 3 &laquo;  Programming Praxis</title>
</head>
<body>
<div class="entrytitle">
<h2>Project Euler Problem&nbsp;3</h2>
<h3>September 20, 2011</h3>
</div>
<div class="entrybody">
<p><a href="http://projecteuler.net/index.php?section=problems&amp;id=3">Problem 3</a> at Project Euler asks the reader to solve this problem:</p>
<blockquote><p>The prime factors of 13195 are 5, 7, 13 and 29. What is the largest prime factor of the number 600851475143?</p></blockquote>
<p>Given the amount of factoring code on this website, I find that problem quite simple. But judging from <a href="http://www.reddit.com/r/learnprogramming/search?q=project+euler+3">Reddit</a> and <a href="http://stackoverflow.com/search?q=600851475143">Stack Overflow</a>, other programmers find the problem anything but simple. If you look at the dates, you will notice that the problem seems to come up every few months. And if you read the comments on Reddit and Stack Overflow, the saddest part is that a lot of the answers are wrong; in fact, some of them are mind-numbingly wrong. So I decided to write a canonical solution to the problem:</p>
<blockquote><p>Project Euler <a href="http://projecteuler.net/index.php?section=problems&amp;id=3">Problem 3</a> asks for the largest prime factor of the number 600851475143. We consider first a function to find all the prime factors of any number. A simple way, not necessarily the best way but sufficient for this task and for many others, works in two steps: first remove factors of 2 while the number is even, then perform trial division by the odd numbers starting from 3 until the factorization is complete. Here&#8217;s a formal statement of the algorithm to find the factors of a given input number <em>n</em>:</p>
<blockquote><p>1. Create a list of factors, initially empty.</p>
<p>2. If <em>n</em> is even, add 2 to the end of the list of factors, divide <em>n</em> by 2, and go to Step 2.</p>
<p>3. Set <em>f</em> &larr; 3.</p>
<p>4. Calculate the quotient <em>q</em> and remainder <em>r</em> when dividing <em>n</em> by <em>f</em>, so that <em>n</em> = <em>q f</em> + <em>r</em> with 0 &le; <em>r</em> &lt; <em>f</em>.</p>
<p>5. If <em>r</em> &gt; 0, set <em>f</em> &larr; <em>f</em> + 2 and go to Step 4.</p>
<p>6. Otherwise, <em>r</em> = 0. Add <em>f</em> to the end of the list of factors. Set <em>n</em> &larr; <em>q</em>.</p>
<p>7. If <em>n</em> &lt; <em>f</em><sup>2</sup>, add <em>n</em> to the end of the list of factors, output the list of factors, and stop.</p>
<p>8. Otherwise, go to Step 4.</p></blockquote>
<p>Consider as an example the factorization of 13195; it&#8217;s odd, so we pass Step 2 and go to Step 3 with <em>f</em> = 3. The quotient and remainder of 13195 &divide; 3 are 4398 and 1, so in Step 5 we set <em>f</em> = 3 + 2 = 5 and go to Step 4. The quotient and remainder of 13195 &divide; 5 are 2639 and 0, so in Step 6 we add 5 to the end of the list of factors, making the list {5}, and we set <em>n</em> = 2639. Then, in Step 7, we note that 2639 &lt; 5<sup>2</sup> is false, so we go to Step 8 and then to Step 4. In Step 4 we calculate the quotient and remainder of 2639 &divide; 5 as 527 and 4, and since the remainder is greater than 0 we set <em>f</em> = 5 + 2 = 7 and go to Step 4. In Step 4 we calculate the quotient and remainder of 2639 &divide; 7 as 377 and 0, so in Step 6 we add 7 to the end of the list of factors, making the list {5, 7}, and we set <em>n</em> = 377. Then, in Step 7, we note that 377 &lt; 7<sup>2</sup> is false, so we go to Step 8 and then to Step 4. In Step 4 we calcuate the quotient and remainder of 377 &divide; 7 as 53 and 6, and since the remainder is greater than 0 we set <em>f</em> = 7 + 2 = 9 and go to Step 4. In Step 4 we calculate the quotient and remainder of 377 &divide; 9 as 41 and 8, and since the remainder is greater than 0 we set <em>f</em> = 9 + 2 = 11 and go to Step 4. In Step 4 we calculate the quotient and remainder of 377 &divide; 11 as 34 and 3, and since the remainder is greater than 0 we set <em>f</em> = 11 + 2 = 13 and go to Step 4. In Step 4 we calculate the quotient and remainder of 377 &divide; 13 as 29 and 0, so in Step 6 we add 13 to the end of the list of factors, making the list {5, 7, 13}, and we set <em>n</em> = 29. Then, in Step 7, we note 29 &lt; 13<sup>2</sup>, so we add 29 to the end of the list of factors, making the list {5, 7, 13, 29}, output the list of factors, and stop. Thus, the complete factorization is 13195 = 5 &times; 7 &times; 13 &times; 29.</p>
<p>Given a function to find the prime factors of a number, the solution to Project Euler Problem 3 is easy: it&#8217;s just the last prime factor in the list, which is necessarily the largest prime factor in the list since we worked with increasing <em>f</em> and always added prime factors to the end of the list.</p>
<p>You may notice that the challenge number in the problem, 600851475143, is too large to represent using 32-bit arithmetic. That&#8217;s part of the Project Euler task &mdash; you need to find a library that allows you to do arithmetic on numbers longer than 32 bits. In fact, Project Euler uses this problem as kind of a gateway exercise, because many of the later problems also require arithmetic on integers longer than 32 bits. With C, the long long datatype is big enough, but you might need the <a href="http://gmplib.org/">gmp</a> library for larger integers, with Java you probably want the BigInteger library, and with other languages you will need to find the corresponding library yourself, and let the compiler know where it is so it can be linked to your factoring code. Or you may prefer to use a language, such as Python or Lisp, that provides built-in support for integers longer than 32 bits.</p>
<p>If you want to know more about integer factorization, I humbly recommend the <a href="http://programmingpraxis.com/contents/themes/#Prime%20Numbers">prime-number exercises</a> at my blog.</p></blockquote>
<p>Your task is to implement the function described above. If you solve the Project Euler problem, please publish only your code but not the solution, as we respect Project Euler&#8217;s request not to publish answers. When you are finished, you are welcome to <a href="/2011/09/20/project-euler-problem-3/2/">read</a> or <a href="http://programmingpraxis.codepad.org/9NbfghJq">run</a> a suggested solution, or to post your own solution or discuss the exercise in the comments below.</p>
<div id="wpcom_below_post" class="wpadvert" style="text-align: center; padding: 5px; background: #; padding: 5px; margin: 10px auto; width: 310px;">
<!-- <span style="text-align: left; letter-spacing: 1px; font: 8px/1em Verdana, sans-serif; color: #ccc; text-transform: uppercase; display: block; padding: 0 1px;">Advertisement</span> -->
<script type="text/javascript">
LD_AddCustomAttr("AdOpt", "1");
LD_AddCustomAttr("Origin", "other");
LD_AddCustomAttr("theme_bg", "ffffff"); 
LD_AddCustomAttr("theme_text", "555555"); 
LD_AddCustomAttr("theme_link", "557799"); 
LD_AddCustomAttr("theme_border", "C8A799"); 
LD_AddCustomAttr("theme_url", "8FB1D3"); 
LD_AddCustomAttr("LangId", "1");
LD_AddCustomAttr("Autotag", "technology");
LD_AddCustomAttr("Autotag", "science");
LD_AddCustomAttr("Tag", "exercises");

LD_AddSlot("wpcom_below_post");
LD_GetBids();
</script>
</div><div class="sharedaddy sd-like-enabled"><div id="wpl-likebox" class="sd-block sd-like"><h3 class="sd-title">Like this:</h3><div class="sd-content"><div id="wpl-button"><a href="http://programmingpraxis.com/2011/09/20/project-euler-problem-3/?like=1&amp;_wpnonce=a72c2c6ab5" title="I like this post" class="like needs-login sd-button" rel="nofollow"><span>Like</span></a></div><div id="wpl-count" class="sd-like-count">Be the first to like this post.</div></div></div></div> <p>Pages: 1 <a href="http://programmingpraxis.com/2011/09/20/project-euler-problem-3/2/">2</a></p> </div></div>
</body>
</html>
