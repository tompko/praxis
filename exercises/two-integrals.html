<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
<title>Two Integrals &laquo;  Programming Praxis</title>
</head>
<body>
<div class="entrytitle">
<h2>Two&nbsp;Integrals</h2>
<h3>January 11, 2011</h3>
</div>
<div class="entrybody">
<p>The exponential integral appears frequently in the study of physics, and the related logarithmic integral appears both in physics and in number theory.  With the Euler-Mascheroni constant &gamma; = 0.5772156649015328606065, formulas for computing the <a onclick="return mugicPopWin(this,event);" oncontextmenu="mugicRightClick(this);" href="http://mathworld.wolfram.com/ExponentialIntegral.html">exponential</a> and <a onclick="return mugicPopWin(this,event);" oncontextmenu="mugicRightClick(this);" href="http://mathworld.wolfram.com/LogarithmicIntegral.html">logarithmic</a> integral are:</p>
<p align="center"><img src="http://s0.wp.com/latex.php?latex=%5Cmathrm%7BEi%7D%5C+%28x%29+%3D+-%5Cint_%7B-x%7D%5E%7B%5Cinfty%7D%5Cfrac%7Be%5E%7B-t%7D%5C+d%5C+t%7D%7Bt%7D+%3D+%5Cgamma+%2B+%5Cmathrm%7Bln%7D%5C+x+%2B+%5Csum_%7Bk%3D1%7D%5E%7B%5Cinfty%7D%5Cfrac%7Bx%5Ek%7D%7Bk+%5Ccdot+k%21%7D&amp;bg=ffffff&amp;fg=555555&amp;s=0" alt="\mathrm{Ei}\ (x) = -\int_{-x}^{\infty}\frac{e^{-t}\ d\ t}{t} = \gamma + \mathrm{ln}\ x + \sum_{k=1}^{\infty}\frac{x^k}{k \cdot k!}" title="\mathrm{Ei}\ (x) = -\int_{-x}^{\infty}\frac{e^{-t}\ d\ t}{t} = \gamma + \mathrm{ln}\ x + \sum_{k=1}^{\infty}\frac{x^k}{k \cdot k!}" class="latex" /></p>
<p align="center"><img src="http://s0.wp.com/latex.php?latex=%5Cmathrm%7BLi%7D%5C+%28x%29+%3D+%5Cmathrm%7BEi%7D%5C+%28%5Cmathrm%7Bln%7D%5C+x%29+%3D+%5Cint_%7B0%7D%5E%7Bx%7D%5Cfrac%7Bd%5C+t%7D%7B%5Cmathrm%7Bln%7D%5C+t%7D+%3D+%5Cgamma+%2B+%5Cmathrm%7Bln%7D%5C+%5Cmathrm%7Bln%7D%5C+x+%2B+%5Csum_%7Bk%3D1%7D%5E%7B%5Cinfty%7D%5Cfrac%7B%28%5Cmathrm%7Bln%7D%5C+x%29%5Ek%7D%7Bk+%5Ccdot+k%21%7D&amp;bg=ffffff&amp;fg=555555&amp;s=0" alt="\mathrm{Li}\ (x) = \mathrm{Ei}\ (\mathrm{ln}\ x) = \int_{0}^{x}\frac{d\ t}{\mathrm{ln}\ t} = \gamma + \mathrm{ln}\ \mathrm{ln}\ x + \sum_{k=1}^{\infty}\frac{(\mathrm{ln}\ x)^k}{k \cdot k!}" title="\mathrm{Li}\ (x) = \mathrm{Ei}\ (\mathrm{ln}\ x) = \int_{0}^{x}\frac{d\ t}{\mathrm{ln}\ t} = \gamma + \mathrm{ln}\ \mathrm{ln}\ x + \sum_{k=1}^{\infty}\frac{(\mathrm{ln}\ x)^k}{k \cdot k!}" class="latex" /></p>
<p>Since there is a singularity at Li(1) = &minus;&infin;, the logarithmic integral is often given in an <em>offset</em> form with the integral starting at 2 instead of 0; the two forms of the logarithmic integral are related by Li<sub>offset</sub>(<em>x</em>) = Li(<em>x</em>) &#8211; Li(2) = Li(<em>x</em>) &#8211; 1.04516378011749278.  It is this form that we are most interested in, because the offset logarithmic integral is a good approximation of the prime counting function &pi;(<em>x</em>), which computes the number of primes less than or equal to <em>x</em>:</p>
<table>
<tr>
<td><em>x</em></td>
<td align="right">10<sup>6</sup></td>
<td align="right">10<sup>21</sup></td>
</tr>
<tr>
<td>Li<sub>offset</sub>(<em>x</em>)</td>
<td>78627</td>
<td>21127269486616126182</td>
</tr>
<tr>
<td>&pi;(<em>x</em>)</td>
<td>78498</td>
<td>21127269486018731928</td>
</tr>
</table>
<p>If you read the mathematical literature, you should be aware that there is some notational confusion about the two forms of the logarithmic integral: some authors use Li for the logarithmic integral and li for its offset variant, other authors turn that convention around, and still other authors use either notation in either (or both!) contexts.  The good news is that in most cases it doesn&#8217;t matter which variant you choose.</p>
<p>Your task is to write functions that compute the exponential integral and the two forms of the logarithmic integral.  When you are finished, you are welcome to <a href="/2011/01/11/two-integrals/2/">read</a> or <a href="http://programmingpraxis.codepad.org/9hg2s20m">run</a> a suggested solution, or to post your own solution or discuss the exercise in the comments below.</p>
</div>
</body>
</html>
