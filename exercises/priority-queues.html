<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
<title>Priority Queues &laquo;  Programming Praxis</title>
</head>
<body>
<div class="entrytitle">
<h2>Priority&nbsp;Queues</h2>
<h3>May 5, 2009</h3>
</div>
<div class="entrybody">
<p>A priority queue is a data structure in which items arrive randomly and depart according to an ordering predicate. It is similar to a normal queue, in which items depart in the order they arrive (first-in, first-out), and a stack, in which items depart in the opposite of the order in which they arrive (last-in, first-out).  The operations on priority queues include insert to add a new item to the queue, find-first to return the first item in the queue, delete-first to return the remaining items after the first, and merge to merge two queues.  Priority queues are used in simulations, where keys correspond to &#8220;event times&#8221; which must be processed in order, in job scheduling for computer systems, where more-important jobs must be performed beforeless-important jobs, and in many other applications.</p>
<p>There are many ways to implement priority queues.  An unordered list makes it easy to insert new items, but each time an item is extracted the entire list must be scanned.  An ordered list makes extraction quick but requires a scan of half the list, on average, each time an item is inserted.  Binary trees give a total ordering of all the items in a priority queue, but we only need to be able to identify the first item, so they do more work than we need.  We will implement priority queues using leftist heaps.</p>
<p>A heap is a binary tree in which each node precedes its two children in a total ordering; the ordering predicate may be less-than or greater-than, as appropriate for the particular heap.  A leftist heap satisfies the additional criterion that the rank of each left node is greater than or equal to the rank of its right sibling, where the rank of a node is the length of its right spine.  As a result, the right spine of any node is always the shortest path to an empty node.  The name leftist heap derives from the fact that the left subtree is usually taller than the right subtree, so a drawing of a leftist heap tends to &#8220;lean&#8221; left.</p>
<p>The fundamental operation on leftist heaps is the merge of two leftist heaps.  This is accomplished by merging their right spines in the same manner as merging two sorted lists; this preserves the heap-order property.  Then the children of the nodes along that new path are swapped as necessary to preserve the leftist property.</p>
<p>Given merge, the remaining operations are trivial.  Insert builds a singleton priority queue, then merges it to the existing priority queue.  Find-first simply returns the item at the root of the tree.  Delete-first merges the two children of the root.</p>
<p>Leftist heaps were invented by Clark Crane in 1972 and popularized by Donald Knuth in 1973.</p>
<p>Your task is to implement the priority queue data structure using leftist heaps.  When you are finished, you are welcome to <a href="/2009/05/05/priority-queues/2/">read</a> or <a href="http://codepad.org/V8v6If7Z">run</a> a suggested solution, or to post your solution or discuss the exercise in the comments below.</p>
<div id="wpcom_below_post" class="wpadvert" style="text-align: center; padding: 5px; background: #; padding: 5px; margin: 10px auto; width: 310px;">
<!-- <span style="text-align: left; letter-spacing: 1px; font: 8px/1em Verdana, sans-serif; color: #ccc; text-transform: uppercase; display: block; padding: 0 1px;">Advertisement</span> -->
<script type="text/javascript">
LD_AddCustomAttr("AdOpt", "1");
LD_AddCustomAttr("Origin", "other");
LD_AddCustomAttr("theme_bg", "ffffff"); 
LD_AddCustomAttr("theme_text", "555555"); 
LD_AddCustomAttr("theme_link", "557799"); 
LD_AddCustomAttr("theme_border", "C8A799"); 
LD_AddCustomAttr("theme_url", "8FB1D3"); 
LD_AddCustomAttr("LangId", "1");
LD_AddCustomAttr("Autotag", "science");
LD_AddCustomAttr("Autotag", "technology");
LD_AddCustomAttr("Autotag", "entertainment");
LD_AddCustomAttr("Tag", "exercises");

LD_AddSlot("wpcom_below_post");
LD_GetBids();
</script>
</div><div class="sharedaddy sd-like-enabled"><div id="wpl-likebox" class="sd-block sd-like"><h3 class="sd-title">Like this:</h3><div class="sd-content"><div id="wpl-button"><a href="http://programmingpraxis.com/2009/05/05/priority-queues/?like=1&amp;_wpnonce=a72c2c6ab5" title="I like this post" class="like needs-login sd-button" rel="nofollow"><span>Like</span></a></div><div id="wpl-count" class="sd-like-count">Be the first to like this post.</div></div></div></div> <p>Pages: 1 <a href="http://programmingpraxis.com/2009/05/05/priority-queues/2/">2</a></p> </div></div>
</body>
</html>
