<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
<title>Elliptic Curves &laquo;  Programming Praxis</title>
</head>
<body>
<div class="entrytitle">
<h2>Elliptic&nbsp;Curves</h2>
<h3>July 28, 2009</h3>
</div>
<div class="entrybody">
<p><img src="http://programmingpraxis.files.wordpress.com/2009/07/ec.jpg?w=640" alt="Image by Jean Brette.  Licensed under Creative Commons Attribution 3.0 Unported license." align="right" />Elliptic curves are a mathematical oddity.  Originally derived from elliptic integrals that measure the area under an ellipse, elliptic curves have relationships to algebra, geometry, and number theory.  Elliptic curves featured in the proof of Fermat&#8217;s last theorem and are used today in integer factorization and cryptography.  We&#8217;ll see applications of elliptic curves in future exercises; the task today is to work out the basic arithmetic of elliptic curves.  The simple definition of an elliptic curve is that it provides all the solutions to a generalized cubic equation.</p>
<p>The standard form of an elliptic curve is <em>y</em><sup>2</sup> = <em>x</em><sup>3</sup> + <em>ax</em> + <em>b</em>; we can also write E<sub><em>a</em>,<em>b</em></sub>.  Any formula that is cubic in two variables can be rewritten into this form via suitable transformations.  In addition to the <em>x</em>,<em>y</em> points defined by the formula, an elliptic curve includes a &#8220;point at infinity,&#8221; denoted by &infin;, analogous to an artist&#8217;s &#8220;vanishing point&#8221; that allows him to depict a three-dimensional image on a two-dimensional canvas.  We will consider only elliptic curves where the discriminant 4<em>a</em><sup>3</sup> + 27<em>b</em><sup>2</sup> is non-zero, meaning that the elliptic curve has no cusps or self-intersections.</p>
<p>The standard operation on an elliptic curve is the addition of two points, as shown in the diagram; this is, of course, different from vector addition of two points on a plane.  Geometrically, points <em>P</em> and <em>Q</em> can be added by projecting a line between them and finding the &#8220;third point&#8221; <em>R</em> where the line intersects the curve, which is the negative of the point <em>P</em> + <em>Q</em>, as shown in the drawing by Jean Brette shown at right.  Further, the point at infinity is the identity element for addition, so that <em>P</em> + &infin; = &infin; + <em>P</em> = <em>P</em> for any point <em>P</em> on an elliptic curve.  Addition is both associative and commutative.</p>
<p>The addition law on elliptic curves is:</p>
<blockquote><p>Given points <em>P</em><sub>1</sub> = (<em>x</em><sub>1</sub>,<em>y</em><sub>1</sub>) and <em>P</em><sub>2</sub> = (<em>x</em><sub>2</sub>,<em>y</em><sub>2</sub>), the point <em>P</em><sub>3</sub> = (<em>x</em><sub>3</sub>,<em>y</em><sub>3</sub>) = <em>P</em><sub>1</sub> + P<sub>2</sub>, where points <em>P</em><sub>1</sub>, <em>P</em><sub>2</sub> and <em>P</em><sub>3</sub> lie on an elliptic curve <em>y</em><sup>2</sup> = <em>x</em><sup>3</sup> + <em>ax</em> + <em>b</em> with non-zero discriminant 4<em>a</em><sup>3</sup> + 27<em>b</em><sup>2</sup>, can be calculated as</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;<em>x</em><sub>3</sub> = <em>s</em><sup>2</sup> &#8211; <em>x</em><sub>1</sub> &#8211; <em>x</em><sub>2</sub></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;<em>y</em><sub>3</sub> = <em>y</em><sub>1</sub> + <em>s</em>(<em>x</em><sub>3</sub> &#8211; <em>x</em><sub>1</sub>)</p>
<p>where the slope <em>s</em> is</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;<em>s</em> = (3<em>x</em><sub>1</sub><sup>2</sup> + a) / (2<em>y</em><sub>1</sub>)</p>
<p>if <em>P</em><sub>1</sub> = <em>P</em><sub>2</sub> and</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;<em>s</em> = (<em>y</em><sub>1</sub> &#8211; <em>y</em><sub>2</sub>) / (<em>x</em><sub>1</sub> &#8211; <em>x</em><sub>2</sub>)</p>
<p>otherwise.</p></blockquote>
<p>The slope of the line connecting two points on an elliptic curve is calculated in the normal way, the difference in the rise divided by the difference in the run, except that if the two points are identical, the line &#8220;connecting&#8221; the two points is the tangent to the curve.  Subtraction is addition of the negative, where the negative of (<em>x</em>,<em>y</em>) is (<em>x</em>,<em>-y</em>).  Multiplication on an elliptic curve is just repeated addition, as it is with regular arithmetic.</p>
<p>We&#8217;ve been discussing elliptic curves over the real numbers, but the formulas work perfectly well on a finite field containing integers relative to a modulus.  The division in the calculation of the slope is multiplication by the modular inverse, so the modulus must be prime.  Our earlier <a href="/2009/07/07/modular-arithmetic/">exercise</a> on modular arithmetic will be helpful.</p>
<p>A simple example may make things clear.  Consider the elliptic curve <em>y</em><sup>2</sup> &equiv; <em>x</em><sup>3</sup> + 4<em>x</em> + 4 (mod 5).  There are eight points on the curve: (0,2), (0,3), (1,2), (1,3), (2,0), (4,2), (4,3) and &infin;; these points can be computed by substituting 0, 1, 2, 3 and 4 for <em>x</em> and computing the modular square root.  Note that when <em>x</em> = 3 there are no solutions because 27 + 12 + 4 &equiv; 43 &equiv; 3 (mod 5) has no square roots, and when <em>x</em> = 2 there is only one solution, 8 + 8 + 4 &equiv; 20 &equiv; 0 (mod 5), and the square root of 0 is 0 regardless of the modulus.  The sum of the points (1,2) and (4,3) is (4,2), the negative of the point (1,2) is (1,3), double the point (1,2) is (2,0), 3 times the point (1,2) is (1,3), 4 times the point (1,2) is &infin;, and 5 times the point (1,2) is (1,2), whence the cycle repeats.</p>
<p>Your task is to write a library of functions for elliptic curves on a finite field.  Your library should provide functions for addition, negation, subtraction, doubling, and multiplication; you may wish to represent a normal point as a triple (<em>x</em> <em>y</em> 1) and the point at infinity as the triple (0 1 0).  When you are finished, you are welcome to <a href="/2009/07/28/elliptic-curves/2/">read</a> or <a href="http://programmingpraxis.codepad.org/rNlg4Pgt">run</a> a suggested solution, or to post your solution or discuss the exercise in the comments below.</p>
</div>
</body>
</html>
