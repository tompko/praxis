<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
<title>The Playfair Cipher &laquo;  Programming Praxis</title>
</head>
<body>
<div class="entrytitle">
<h2>The Playfair&nbsp;Cipher</h2>
<h3>July 3, 2009</h3>
</div>
<div class="entrybody">
<p>One of the most famous of the classical ciphers was the Playfair cipher, invented by Sir Charles Wheatstone in 1854 but popularized by Lord Lyon Playfair.  The cipher was used by the British during the Boer War and World War I, and was still in use as a field-grade cipher as late as World War II, probably because it is simple to teach, fast to use, requires no special equipment, and was reasonably secure by the standards of the day; by the time enemy cryptanalysts could break the message, its contents were useless to them.</p>
<p>Playfair uses a 5-square block containing the pass-phrase; the letter J is mapped to I to make the 26-letter alphabet fit the 5-square block.  The pass-phrase is first filled in to the 5-square block, then the remaining letters of the alphabet complete the 5-square block, with duplicates removed.  For instance, the pass-phrase PLAYFAIR leads to this 5-square block:</p>
<p><code>P L A Y F<br />
I R B C D<br />
E G H K M<br />
N O Q S T<br />
U V W X Z</code></p>
<p>Some variants of Playfair omit Q instead of J, or start the key from the bottom-right corner and work backwards; we&#8217;ll stick with the standard method.</p>
<p>The message to be encrypted is split into digrams, with J mapped to I.  In addition, no digram may use the same letter twice, so an X is inserted if needed (some Playfair variants use Z or Q instead of X).  Likewise, if the last digram has only a single letter, an X is added to the end of the message.  For instance, the plain-text PROGRAMMING PRAXIS is split as:</p>
<p><code>PR OG RA MX MI NG PR AX IS</code></p>
<p>Then each digram is enciphered separately according to the following rules:</p>
<ol>
<li>If the two letters of the digram are in the same row, they are replaced pairwise by the letters to their immediate right, wrapping around to the left of the row if needed.</li>
<li>If the two letters of the digram are in the same column, they are replaced pairwise by the letters immediately below, wrapping around to the top of the column if needed.</li>
<li>Otherwise, the first letter of the digram is replaced by the letter in the same row as the first letter of the digram and the same column as the second letter of the digram, and the second letter of the digram is replaced by the letter in the same row as the second letter of the digram and the same column as the first letter of the digram.</li>
</ol>
<p>For instance, the PR digram is enciphered as LI, because P and R are in different rows and columns, and the OG digram is enciphered as VO, since O and G are in the same column.  The complete encipherment is shown below:</p>
<p><code>PR OG RA MX MI NG PR AX IS<br />
LI VO BL KZ ED OE LI YW CN</code></p>
<p>The coded message is thus LIVOBLKZEDOELIYWCN.  Decryption is simply the inverse of encryption.</p>
<p>Playfair is rather more secure than simpler substitution ciphers because it works with digrams rather than single letters, rendering simple frequency analysis moot.  Frequency analysis on digrams is possible, but requires considerably more cipher-text than frequency analysis on single letters because Playfair admits 600 digrams whereas simple substitution admits only 26 letters.  Manual cryptanalysis looks at commonly-reversed digrams such as REceivER and DEcodED; if some plain-text is known (such as a standard message header), it is easy to recover at least a partial key.</p>
<p>The most famous use of the Playfair cipher came in 1943.  David Kahn writes in <em>The Codebreakers</em>:</p>
<blockquote><p>
Perhaps the most famous cipher of 1943 involved the future president of the U.S., J. F. Kennedy, Jr. On 2 August 1943, Australian Coastwatcher Lieutenant Arthur Reginald Evans of the Royal Australian Naval Volunteer Reserve saw a pinpoint of flame on the dark waters of Blackett Strait from his jungle ridge on Kolombangara Island, one of the Solomons. He did not know that the Japanese destroyer Amagiri had rammed and sliced in half an American patrol boat PT-109, under the command of Lieutenant John F. Kennedy, United States Naval Reserve. Evans received the following message at 0930 on the morning of the 2 of August 1943:</p>
<p><code>KXJEY  UREBE  ZWEHE  WRYTU  HEYFS<br />
KREHE  GOYFI  WTTTU  OLKSY  CAJPO<br />
BOTEI  ZONTX  BYBWT  GONEY  CUZWR<br />
GDSON  SXBOU  YWRHE  BAAHY  USEDQ</code></p>
<p>The translation:</p>
<p><code>PT BOAT ONE OWE NINE LOST IN ACTION IN BLACKETT<br />
STRAIT TWO MILES SW MERESU COVE X CREW OF TWELVE<br />
X REQUEST ANY INFORMATION.</code></p>
<p>The coastwatchers regularly used the Playfair system. Evans deciphered it with the key ROYAL NEW ZEALAND NAVY and learned of Kennedy&#8217;s fate. [...] About ten hours later, at 10:00 p.m. Kennedy and his crew was rescued.
</p></blockquote>
<p>Your task is to write functions that encipher and decipher messages using the Playfair cipher.  When you are finished, you are welcome to <a href="/2009/07/03/the-playfair-cipher/2/">read</a> or <a href="http://programmingpraxis.codepad.org/1lKnWAtU">run</a> a suggested solution, or to post your own solution or discuss the exercise in the comments below.</p>
</div>
</body>
</html>
