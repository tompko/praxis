<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
<title>Beautiful Code &laquo;  Programming Praxis</title>
</head>
<body>
<div class="entrytitle">
<h2>Beautiful&nbsp;Code</h2>
<h3>September 11, 2009</h3>
</div>
<div class="entrybody">
<p>In their book <em>The Practice of Programming</em>, Brian Kernighan and Rob Pike present this code for matching simple regular expressions consisting of literal characters, a dot matching any character, a star consisting of zero or more repetitions of the preceding character, and a caret and a dollar sign representing the beginning or end of the search string:</p>
<p><code>&#47;* match: search for re anywhere in text *&#47;<br />
int match(char *re, char *text)<br />
{<br />
&nbsp;&nbsp;&nbsp;if (re[0] == &#39;^&#39;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return matchhere(re+1, text);<br />
&nbsp;&nbsp;&nbsp;do {  &#47;* must look at empty string *&#47;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (matchhere(re, text))<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1;<br />
&nbsp;&nbsp;&nbsp;} while (*text++ != &#39;&#92;0&#39;);<br />
&nbsp;&nbsp;&nbsp;return 0;<br />
}</code></p>
<p><code>&#47;* matchhere: search for re at beginning of text *&#47;<br />
int matchhere(char *re, char *text)<br />
{<br />
&nbsp;&nbsp;&nbsp;if (re[0] == &#39;&#92;0&#39;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1;<br />
&nbsp;&nbsp;&nbsp;if (re[1] == &#39;*&#39;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return matchstar(re[0], re+2, text);<br />
&nbsp;&nbsp;&nbsp;if (re[0] == &#39;$&#39; &amp;&amp; re[1] == &#39;&#92;0&#39;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return *text == &#39;&#92;0&#39;;<br />
&nbsp;&nbsp;&nbsp;if (*text!=&#39;&#92;0&#39; &amp;&amp; (re[0]==&#39;.&#39; || re[0]==*text))<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return matchhere(re+1, text+1);<br />
&nbsp;&nbsp;&nbsp;return 0;<br />
}</code></p>
<p><code>&#47;* matchstar: search for c*re at beginning of text *&#47;<br />
int matchstar(int c, char *re, char *text)<br />
{<br />
&nbsp;&nbsp;&nbsp;do {  &#47;* a * matches zero or more instances *&#47;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (matchhere(re, text))<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1;<br />
&nbsp;&nbsp;&nbsp;} while (*text!=&#39;&#92;0&#39; &amp;&amp; (*text++==c || c==&#39;.&#39;));<br />
&nbsp;&nbsp;&nbsp;return 0;<br />
}</code></p>
<p>Many readers commented on the beauty of the code, and in a later book, <em>Beautiful Code</em> by Andy Oram and Greg Wilson, Kernighan explained the history of the code.</p>
<p>Your task is to port the code to your favorite language. You should use the features and idioms of your language, while simultaneously preserving the beauty of Rob Pike&#8217;s regular expression matcher.  When you are finished, you are welcome to <a href="/2009/09/11/beautiful-code/2/">read</a> or <a href="http://programmingpraxis.codepad.org/vv72J3XE">run</a> a suggested solution, or to post your solution or discuss the exercise in the comments below.</p>
</div>
</body>
</html>
