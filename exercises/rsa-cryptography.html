<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
<title>RSA Cryptography &laquo;  Programming Praxis</title>
</head>
<body>
<div class="entrytitle">
<h2>RSA&nbsp;Cryptography</h2>
<h3>November 16, 2010</h3>
</div>
<div class="entrybody">
<p>In 1973, Clifford Cocks invented a method of public-key cryptography in which the recipient of a message holds a private key, known only to himself, and publishes a public key, which may be used by anyone to send him a message that only he will be able to read.  Cocks worked for the British security service GCHQ, so he was unable to publish his work.  In 1978, three MIT professors, Ronald L. Rivest, Leonard M. Adelman and Adi Shamir invented the same algorithm, independently, which they patented in 1983.  The algorithm is now known as RSA, after their initials.</p>
<p>The basic idea of RSA starts with two large prime numbers of equal bit-length, <em>p</em> and <em>q</em>; their product <em>n</em> becomes the modulus of the cryptosystem.  The totient of <em>n</em> is computed as &phi;(<em>pq</em>) = (<em>p</em>&minus;1) &times; (<em>q</em>&minus;1).  Then two keys are chosen, the encryption key <em>e</em> and the decryption key <em>d</em>, such that <em>de</em> &equiv; 1 (mod &phi;(<em>pq</em>)) and gcd(<em>e</em>, &phi;(<em>pq</em>)) = 1.  Then, given a message <em>m</em>, an integer on the range 0 &lt; <em>m</em> &lt;<em>n</em>, the message is encrypted by computing <em>m<sup>e</sup></em> (mod <em>n</em>) and the resulting cipher-text <em>c</em> is decrypted by computing <em>c<sup>d</sup></em> (mod <em>n</em>).</p>
<p>In practice, the keys are generated by selecting a bit-length <em>k</em> and and arbitrary encryption key <em>e</em>.  A longer bit-length provides more security than a shorter bit-length; a 768-bit key has recently been factored, albeit with <a href="http://eprint.iacr.org/2010/006.pdf">extreme effort</a> (about 2000 PC-years), most commercial users of RSA are probably using 1024- or 2048-bit keys these days, and high-security users (banks, military, government, criminals) are probably using 4096- or 8192-bit keys. <em>E</em> must be odd, is frequently chosen to be prime to force the condition that it is co-prime to the totient, and is generally fairly small; <em>e</em> = 2<sup>16</sup>+1 = 65537 is common.  Then the key generator chooses <em>p</em> and <em>q</em> at random, computes <em>d</em> as the modular inverse of <em>e</em>, and reports <em>n</em> and <em>d</em>.  In that way, nobody, not even the person generating the keys, knows <em>p</em> and <em>q</em>.</p>
<p>Here is a simple example from <a href="http://en.wikipedia.org/wiki/Rsa">Wikipedia</a>:  Choose <em>p</em> = 61 and <em>q</em> = 53.  Then <em>n</em> = <em>p</em>&times;<em>q</em> = 3233 and the totient &phi;(<em>pq</em>) = 60&times;52 = 3120.  Choose <em>e</em>=17 which is co-prime to 3120 since 17 is prime and 17&#8740;3120; the corresponding <em>d</em> is the inverse of 17 with respect to the modulus 3120, so <em>d</em> = 2753.  Then the message <em>m</em> = 65 is encrypted as <em>c</em> = <em>m<sup>e</sup></em> (mod <em>n</em>) = 65<sup>17</sup> (mod 3233) = 2790, and the cipher-text 2790 is decrypted as <em>m</em> = <em>c<sup>d</sup></em> (mod <em>n</em>) = 2790<sup>2753</sup> (mod 3233) = 65.</p>
<p>The standard definition of RSA cryptography is known as <a href="http://www.rsa.com/rsalabs/node.asp?id=2125">PKCS #1</a>.  It provides a method for converting a text message to a number <em>m</em> suitable for encryption, and converting it back to the original text message, but we won&#8217;t examine that algorithm today.  It is also possible to use RSA to provide non-forgeable signatures; the basic idea is that the sender encrypts a message hash with his decryption key, so the receiver can decrypt the message hash with the sender&#8217;s public key, which works because only the sender knows his private decryption key. </p>
<p>Your task is to write an RSA key generator and procedures to encrypt and decrypt messages using the RSA algorithm as described above.  When you are finished, you are welcome to <a href="/2010/11/16/rsa-cryptography/2/">read</a> or <a href="http://programmingpraxis.codepad.org/rRxeR2C9">run</a> a suggested solution, or to post your own solution or discuss the exercise in the comments below.</p>
<div id="wpcom_below_post" class="wpadvert" style="text-align: center; padding: 5px; background: #; padding: 5px; margin: 10px auto; width: 310px;">
<!-- <span style="text-align: left; letter-spacing: 1px; font: 8px/1em Verdana, sans-serif; color: #ccc; text-transform: uppercase; display: block; padding: 0 1px;">Advertisement</span> -->
<script type="text/javascript">
LD_AddCustomAttr("AdOpt", "1");
LD_AddCustomAttr("Origin", "other");
LD_AddCustomAttr("theme_bg", "ffffff"); 
LD_AddCustomAttr("theme_text", "555555"); 
LD_AddCustomAttr("theme_link", "557799"); 
LD_AddCustomAttr("theme_border", "C8A799"); 
LD_AddCustomAttr("theme_url", "8FB1D3"); 
LD_AddCustomAttr("LangId", "1");
LD_AddCustomAttr("Autotag", "technology");
LD_AddCustomAttr("Tag", "exercises");

LD_AddSlot("wpcom_below_post");
LD_GetBids();
</script>
</div><div class="sharedaddy sd-like-enabled"><div id="wpl-likebox" class="sd-block sd-like"><h3 class="sd-title">Like this:</h3><div class="sd-content"><div id="wpl-button"><a href="http://programmingpraxis.com/2010/11/16/rsa-cryptography/?like=1&amp;_wpnonce=a72c2c6ab5" title="I like this post" class="like needs-login sd-button" rel="nofollow"><span>Like</span></a></div><div id="wpl-count" class="sd-like-count">Be the first to like this post.</div></div></div></div> <p>Pages: 1 <a href="http://programmingpraxis.com/2010/11/16/rsa-cryptography/2/">2</a></p> </div></div>
</body>
</html>
